{% extends 'Base/base.html' %}

{% block title %}
Settings
{% endblock %}

{% block content %}


<h1 class="form-header">Plant Profile</h1>
<div class="form-wrapper">
	<form action="/settings/" method="post" id="plant_profile_form" name="plant_profile_form">
	    {% csrf_token %}
	    {{ plant_profile_form.as_p }}
	</form>
</div>

<h1 class="form-header">Healthy Levels</h1>
<div class="form-wrapper">
	<form action="/settings/" method="post" id="healthy_levels_form" name="healthy_levels_form">
	    {% csrf_token %}
	    {{ healthy_levels_form.as_p }}
	</form>

	{% if can_save %}
		<button class="save-profile-button" onclick="showSaveProfileModal()">Save As New Profile</button>
	{% endif %}
</div>

<div id="save-profile-modal" class="save-profile-modal">
	<div class="form-wrapper save-profile-form-wrapper">
		<form action="/settings/" method="post" id="save_profile_form" name="save_profile_form">
		    {% csrf_token %}
		    {{ save_profile_form.as_p }}
		    <!-- <input class="save-profile-submit" type="submit" value="Save"> -->
		    <button class="save-profile-submit" onclick="submitSaveProfileForm()">Save</button>
		</form>
	</div>
</div>

<div id="sidebar" class="sidebar">
	<div class="sidebar-toggle-button-wrapper" id="sidebar-toggle-button-wrapper">
		<button class="sidebar-toggle-button" id="sidebar-toggle-button" onclick="toggleSidebar()"><</button>
	</div>
	<!-- <div class="sidebar-collapse-button-wrapper" id="sidebar-collapse-button-wrapper">
		<button class="sidebar-collapse-button" onclick="toggleSidebar()">></button>
	</div> -->
	<div class="sidebar-content-wrapper" id="sidebar-content-wrapper">
		<div class="sidebar-section-wrapper">
			<div class="sidebar-section-header">
				Current Values
			</div>
			<div class="sidebar-section-content">
				<div class="sidebar-value-label">
					Temperature
				</div>
				<div>
					70
				</div>
				<div class="sidebar-value-label">
					Humidity
				</div>
				<div>
					82%
				</div>
				<div class="sidebar-value-label">
					Soil Moisture
				</div>
				<div>
					37%
				</div>
				<div class="sidebar-value-label">
					Light
				</div>
				<div>
					105 lm
				</div>
			</div>
		</div>
		<div class="sidebar-section-wrapper">
			<div class="sidebar-section-header">
				Legend
			</div>
			<div class="sidebar-section-content">
				<div class="lenged-row-wrapper">
					<div class="legend-row-label">
						Temperature
					</div>
					<button class="legend-row-button" id="expand-legend-button-temperature" onclick="expandLegend('temperature')">></button>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	document.getElementById("id_plant_profile").options[0].disabled = true;

	function showSaveProfileModal() {
		document.getElementById("save-profile-modal").style.display = "flex";
	}

	function submitSaveProfileForm() {
		document.getElementById("id_custom_temperature").value = document.getElementById("id_temperature").value
		document.getElementById("id_custom_humidity").value = document.getElementById("id_humidity").value
		document.getElementById("id_custom_soil_moisture").value = document.getElementById("id_soil_moisture").value
		document.getElementById("id_custom_sunlight").value = document.getElementById("id_sunlight").value

		document.getElementById("save_profile_form").submit()
	}

	var sidebar_hidden = true;

	function toggleSidebar() {
		if (sidebar_hidden) {
			document.getElementById("sidebar").style.width = "350px";
			document.getElementById("sidebar-toggle-button-wrapper").style.justifyContent = "flex-end";
			document.getElementById("sidebar-toggle-button-wrapper").style.transform = "rotate(180deg)";
			document.getElementById("sidebar-content-wrapper").style.display="grid";
		}
		else {
			document.getElementById("sidebar").style.width = "30px";
			document.getElementById("sidebar-toggle-button-wrapper").style.transform = "none";
			document.getElementById("sidebar-toggle-button-wrapper").style.justifyContent = "center";
			document.getElementById("sidebar-content-wrapper").style.display="none";
		}

		sidebar_hidden = !sidebar_hidden
	}

	var temperature_expanded = false;
	var humidity_expanded = false;
	var soil_moisture_expanded = false;
	var sunlight_expanded = false;

	function expandLegend(type) {
		if (type == "temperature"){
			if (temperature_expanded) {
				document.getElementById("expand-legend-button-temperature").style.transform = "rotate(90deg)";
			}
			else {
				document.getElementById("expand-legend-button-temperature").style.transform = "rotate(-90deg)";
			}

			temperature_expanded = !temperature_expanded
		}
	}
</script>
{% endblock %}